{"ast":null,"code":"import Router from 'next/router';\nimport axios from 'axios';\nimport { AUTHENTICATE, DEAUTHENTICATE, USER } from './ActionsTypes';\nimport { API } from '../../config';\nimport { setCookie, removeCookie } from '../../utils/cookie'; // register user\n\nconst register = (userdata, type) => {\n  if (type !== 'register') {\n    throw new Error('Wrong API call!');\n  }\n\n  return dispatch => {\n    const {\n      firstname,\n      lastname,\n      mobile_no,\n      email_id,\n      password,\n      confirm_password\n    } = userdata;\n    axios.post(`${API}/${type}`, {\n      firstname,\n      lastname,\n      mobile_no,\n      email_id,\n      password,\n      confirm_password\n    }).then(response => {\n      Router.push('/signin');\n      console.log(response.data.meta.message);\n    }).catch(error => {\n      switch (error.response.status) {\n        case 422:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 401:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 500:\n          alert('Interval server error! Try again!');\n          break;\n\n        default:\n          alert(error.response.data.meta.message);\n          break;\n      }\n    });\n  };\n}; // gets token from the api and stores it in the redux store and in cookie\n\n\nconst authenticate = (userdata, type) => {\n  if (type !== 'login') {\n    throw new Error('Wrong API call!');\n  }\n\n  return dispatch => {\n    const {\n      email_id,\n      password\n    } = userdata;\n    axios.post(`${API}/${type}`, {\n      email_id,\n      password\n    }).then(response => {\n      console.log(response.data.data.user.token);\n      setCookie('token', response.data.data.user.token);\n      Router.push('/users');\n      dispatch({\n        type: AUTHENTICATE,\n        payload: response.data.data.user.token\n      });\n    }).catch(error => {\n      console.log(error);\n\n      switch (error.response.status) {\n        case 422:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 401:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 500:\n          alert('Interval server error! Try again!');\n          break;\n\n        default:\n          alert(error.response.data.meta.message);\n          break;\n      }\n    });\n  };\n}; // gets the token from the cookie and saves it in the store\n\n\nconst reauthenticate = token => {\n  return dispatch => {\n    dispatch({\n      type: AUTHENTICATE,\n      payload: token\n    });\n  };\n}; // removing the token\n\n\nconst deauthenticate = () => {\n  return dispatch => {\n    removeCookie('token');\n    Router.push('/');\n    dispatch({\n      type: DEAUTHENTICATE\n    });\n  };\n};\n\nconst getUser = ({\n  token\n}, type) => {\n  console.log(token);\n  return dispatch => {\n    axios.get(`${API}/${type}`, {\n      headers: {\n        \"Authorization\": \"bearer \" + token\n      }\n    }).then(response => {\n      dispatch({\n        type: USER,\n        payload: response.data.data.user\n      });\n    }).catch(error => {\n      switch (error.response.status) {\n        case 401:\n          Router.push('/');\n          break;\n\n        case 422:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 500:\n          alert('Interval server error! Try again!');\n\n        case 503:\n          alert(error.response.data.meta.message);\n          Router.push('/');\n          break;\n\n        default:\n          alert(error.response.data.meta.message);\n          break;\n      }\n    });\n  };\n};\n\nexport default {\n  register,\n  authenticate,\n  reauthenticate,\n  deauthenticate,\n  getUser\n};","map":{"version":3,"sources":["/var/local/react/next-struc/store/actions/auth.tsx"],"names":["Router","axios","AUTHENTICATE","DEAUTHENTICATE","USER","API","setCookie","removeCookie","register","userdata","type","Error","dispatch","firstname","lastname","mobile_no","email_id","password","confirm_password","post","then","response","push","console","log","data","meta","message","catch","error","status","alert","authenticate","user","token","payload","reauthenticate","deauthenticate","getUser","get","headers"],"mappings":"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","sourcesContent":["import Router from 'next/router';\r\nimport axios from 'axios';\r\nimport { AUTHENTICATE, DEAUTHENTICATE, USER } from './ActionsTypes';\r\nimport { API } from '../../config';\r\nimport { setCookie, removeCookie } from '../../utils/cookie';\r\n\r\n// register user\r\ninterface Dispatch {\r\n    type: string,\r\n    payload: any\r\n}\r\nconst register = (userdata: any, type: any) => {\r\n    if (type !== 'register') {\r\n        throw new Error('Wrong API call!');\r\n    }\r\n    return (dispatch: Dispatch) => {\r\n        const { firstname, lastname, mobile_no, email_id, password, confirm_password } = userdata\r\n        axios.post(`${API}/${type}`, { firstname, lastname, mobile_no, email_id, password, confirm_password })\r\n            .then((response) => {\r\n                Router.push('/signin');\r\n                console.log(response.data.meta.message);\r\n            })\r\n            .catch((error) => {\r\n                switch (error.response.status) {\r\n                    case 422:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                    case 401:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                    case 500:\r\n                        alert('Interval server error! Try again!');\r\n                        break;\r\n                    default:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                }\r\n            });\r\n    };\r\n};\r\n// gets token from the api and stores it in the redux store and in cookie\r\nconst authenticate = (userdata: any, type: string) => {\r\n    if (type !== 'login') {\r\n        throw new Error('Wrong API call!');\r\n    }\r\n    return (dispatch: Dispatch) => {\r\n        const { email_id, password } = userdata;\r\n        axios.post(`${API}/${type}`, { email_id, password })\r\n            .then((response) => {\r\n                console.log(response.data.data.user.token);\r\n                setCookie('token', response.data.data.user.token);\r\n                Router.push('/users');\r\n                dispatch({ type: AUTHENTICATE, payload: response.data.data.user.token });\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n                switch (error.response.status) {\r\n                    case 422:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                    case 401:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                    case 500:\r\n                        alert('Interval server error! Try again!');\r\n                        break;\r\n                    default:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                }\r\n\r\n            });\r\n    };\r\n};\r\n\r\n// gets the token from the cookie and saves it in the store\r\nconst reauthenticate = (token: any) => {\r\n    return (dispatch: Dispatch) => {\r\n        dispatch({ type: AUTHENTICATE, payload: token });\r\n    };\r\n};\r\n\r\n// removing the token\r\nconst deauthenticate = () => {\r\n    return (dispatch: Dispatch) => {\r\n        removeCookie('token');\r\n        Router.push('/');\r\n        dispatch({ type: DEAUTHENTICATE });\r\n    };\r\n};\r\n\r\nconst getUser = ({ token }: any, type: any) => {\r\n    console.log(token)\r\n    return (dispatch: Dispatch) => {\r\n        axios.get(`${API}/${type}`, {\r\n            headers: {\r\n                \"Authorization\": \"bearer \" + token\r\n            }\r\n        })\r\n            .then((response) => {\r\n                dispatch({ type: USER, payload: response.data.data.user });\r\n            })\r\n            .catch((error) => {\r\n                switch (error.response.status) {\r\n                    case 401:\r\n                        Router.push('/');\r\n                        break;\r\n                    case 422:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                    case 500:\r\n                        alert('Interval server error! Try again!');\r\n                    case 503:\r\n                        alert(error.response.data.meta.message);\r\n                        Router.push('/');\r\n                        break;\r\n                    default:\r\n                        alert(error.response.data.meta.message);\r\n                        break;\r\n                }\r\n            });\r\n    };\r\n};\r\n\r\n\r\nexport default {\r\n    register,\r\n    authenticate,\r\n    reauthenticate,\r\n    deauthenticate,\r\n    getUser,\r\n};"]},"metadata":{},"sourceType":"module"}