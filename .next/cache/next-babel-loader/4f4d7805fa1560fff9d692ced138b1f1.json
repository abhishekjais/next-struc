{"ast":null,"code":"import mongoose from \"mongoose\";\nconst connection = {\n  isConnected: false || 0\n};\n\nconst database = async (req, res, next) => {\n  if (connection.isConnected) {\n    return next();\n  }\n\n  const db = await mongoose.connect(process.env.MONGO_URI, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n    useFindAndModify: false\n  });\n  connection.isConnected = db.connections[0].readyState;\n  console.log(connection.isConnected, '-----------');\n  req.db = process.env.DB_NAME;\n  req.dbClient = db;\n  return next();\n};\n\nexport default database;","map":{"version":3,"sources":["D:/React/next-struc/middlewares/database.js"],"names":["mongoose","connection","isConnected","database","req","res","next","db","connect","process","env","MONGO_URI","useNewUrlParser","useUnifiedTopology","useFindAndModify","connections","readyState","console","log","DB_NAME","dbClient"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;AACA,MAAMC,UAAU,GAAG;AACfC,EAAAA,WAAW,EAAE,SAAS;AADP,CAAnB;;AAGA,MAAMC,QAAQ,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AACvC,MAAIL,UAAU,CAACC,WAAf,EAA4B;AACxB,WAAOI,IAAI,EAAX;AACH;;AACD,QAAMC,EAAE,GAAG,MAAMP,QAAQ,CAACQ,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,SAA7B,EAAwC;AACrDC,IAAAA,eAAe,EAAE,IADoC;AAErDC,IAAAA,kBAAkB,EAAE,IAFiC;AAGrDC,IAAAA,gBAAgB,EAAE;AAHmC,GAAxC,CAAjB;AAKAb,EAAAA,UAAU,CAACC,WAAX,GAAyBK,EAAE,CAACQ,WAAH,CAAe,CAAf,EAAkBC,UAA3C;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYjB,UAAU,CAACC,WAAvB,EAAoC,aAApC;AACAE,EAAAA,GAAG,CAACG,EAAJ,GAASE,OAAO,CAACC,GAAR,CAAYS,OAArB;AACAf,EAAAA,GAAG,CAACgB,QAAJ,GAAeb,EAAf;AACA,SAAOD,IAAI,EAAX;AACH,CAdD;;AAeA,eAAeH,QAAf","sourcesContent":["import mongoose from \"mongoose\";\nconst connection = {\n    isConnected: false || 0\n}\nconst database = async (req, res, next) => {\n    if (connection.isConnected) {\n        return next();\n    }\n    const db = await mongoose.connect(process.env.MONGO_URI, {\n        useNewUrlParser: true,\n        useUnifiedTopology: true,\n        useFindAndModify: false\n    });\n    connection.isConnected = db.connections[0].readyState;\n    console.log(connection.isConnected, '-----------');\n    req.db = process.env.DB_NAME;\n    req.dbClient = db;\n    return next();\n}\nexport default database;"]},"metadata":{},"sourceType":"module"}